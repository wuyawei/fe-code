# Node.js 服务端核心技术与应用

## 一、核心技术与原理

### 1.1 事件循环与异步 I/O 模型
- **事件循环 (基于 Libuv)**:
    -   详解其核心阶段 (Timers, Poll, Check 等) 与任务队列 (宏任务, 微任务, `nextTick`)。
    -   对比 Node.js 与浏览器事件循环的差异与特性。
- **异步非阻塞 I/O**:
    -   理解 Node.js 如何通过 Libuv (线程池、事件驱动) 实现 I/O 操作不阻塞主线程。
    -   掌握 `Promise` 和 `async/await` 在 Node.js 异步流程控制中的最佳实践。
    - **应用**: 编写高效的异步代码，理解执行顺序，诊断性能瓶颈。

### 1.2 Stream 与 Buffer
- **Buffer**:
    -   Node.js 处理二进制数据的基石：内存分配、读写操作。
    -   与字符串、JSON 的高效转换及编码处理 (UTF-8, Base64)。
- **Stream (流)**:
    -   四种基本类型 (Readable, Writable, Duplex, Transform) 的原理与应用场景。
    -   核心 API (`pipe`, `on('data')`, `write()`) 与事件。
    -   背压 (Backpressure) 机制的理解与处理。
    - **应用**: 高效处理大文件传输、网络数据流、构建数据处理管道。

### 1.3 模块系统 (CJS/ESM)
- **CommonJS (CJS)**: `require` 机制、`module.exports`/`exports`、模块缓存原理。
- **ES Modules (ESM)**: Node.js 中的 `import`/`export` 语法、`package.json` 配置 (`"type": "module"`)、动态 `import()`。
- **互操作性**: CJS 与 ESM 模块相互加载的规则与注意事项。
    - **应用**: 管理项目依赖，组织代码结构，理解不同模块化方案对项目的影响。

### 1.4 进程与子进程
- **`process` 对象**: 访问环境变量、命令行参数、标准流、进程事件。
- **`child_process` 模块**:
    -   `spawn`, `exec`, `execFile`, `fork` 的使用场景与差异。
    -   进程间通信 (IPC) 基础 (尤其 `fork`)。
    - **应用**: 利用多核 CPU、执行外部命令、隔离任务、创建守护进程。

### 1.5 性能分析与内存管理基础
- **性能分析入门**:
    -   使用内置 Profiler 或 V8 Inspector Protocol 进行基础性能瓶颈分析。
    -   识别常见阻塞事件循环的操作。
- **内存管理 (GC) 基础**:
    -   了解 V8 垃圾回收机制 (新生代/老生代) 对 Node.js 应用的影响。
    -   识别明显内存泄漏的工具与方法 (如 Heapdump)。
    - **应用**: 编写内存和 CPU 友好的代码，进行基本的性能问题诊断。

## 二、Web 服务与 API 开发

### 2.1 Web 框架应用 (Express/Koa/NestJS,egg.js/Midway)
- **核心概念**:
    -   理解不同框架的中间件模型 (Express/Koa 的线性/洋葱模型, NestJS 的模块化与依赖注入)。
    -   掌握路由定义、请求处理、响应发送的基本流程。
- **框架选型考量**: 结合项目需求、团队熟悉度、生态支持等因素。
    - **应用**: 快速、结构化地构建 Web 服务器和 API。

### 2.2 中间件原理与实践
- **核心作用**: 解耦请求处理逻辑、实现横切关注点 (如日志、认证、错误处理)。
- **执行流程**: `next()` 函数的调用与控制流。
- **常用中间件**: Body-parser, CORS, 身份验证, 日志记录等。
    - **应用**: 编写可复用、可组合的请求处理单元。

### 2.3 RESTful API / GraphQL API 设计与实现
- **RESTful API**:
    -   核心原则：资源、URI 设计、HTTP 方法语义、状态码应用。
    -   使用框架实现 CRUD 操作。
- **GraphQL API**:
    -   基本概念：Schema 定义, Query, Mutation, Resolver。
    -   使用 Apollo Server 或框架集成实现。
    - **应用**: 设计和实现前后端数据交互接口。

### 2.4 数据库交互核心 (ORM/ODM)
- **ORM (Prisma/TypeORM)**:
    -   模型 (Entity) 定义与数据库表映射。
    -   核心 CRUD 操作、关系查询基础。
- **ODM (Mongoose for MongoDB)**:
    -   Schema 定义、模型操作、常用查询方法。
- **连接池**: 理解其基本作用与配置。
    - **应用**: 实现业务数据与数据库的交互与持久化。

### 2.5 身份验证与授权基础 (JWT/OAuth)
- **JWT (JSON Web Tokens)**:
    -   Token 的结构、生成、验证流程。
    -   在请求头中传递与服务端校验。
- **OAuth 2.0 基础**:
    -   理解其作为授权框架的角色 (而非特定认证协议)。
    -   了解授权码 (Authorization Code) 流程的基本步骤。
    - **应用**: 实现用户登录认证和 API 访问控制。

### 2.6 服务端测试基础 (单元/集成)
- **单元测试**:
    -   使用 Jest/Vitest 测试独立的函数或模块 (可能需要 Mock)。
- **集成测试**:
    -   测试模块间的交互，特别是涉及数据库或外部依赖的 API 端点 (使用 Supertest 等)。
    - **应用**: 保证服务端逻辑的正确性，支持代码重构和持续集成。

## 三、(工程化) 工具链与 CLI 开发

### 3.1 开发 NPM 包 / CLI 工具
- **NPM 包**:
    -   `package.json` 核心字段 (`main`, `bin`, `scripts`, `dependencies`)。
    -   开发、测试、发布流程 (`npm link`, `npm publish`)。
- **CLI 工具**:
    -   使用 `commander` 或 `yargs` 解析命令行参数与选项。
    -   结合 `fs` 模块进行文件读写、创建、删除等操作。
    -   使用 `inquirer` 实现交互式命令行界面。
    - **应用**: 创建项目脚手架、自动化脚本、代码生成器等提效工具。

### 3.2 编写构建工具插件 (Webpack/Vite)
- **基本原理**: 理解构建工具 (如 Webpack, Vite) 的插件机制和生命周期钩子。
- **插件开发**:
    -   访问和修改构建过程中的资源或配置。
    -   实现特定的构建逻辑 (如代码转换、资源优化、信息输出)。
    - **应用**: 定制和扩展前端构建流程，满足特定项目需求。

## 结语

聚焦于 Node.js 在服务端和工程化领域的核心应用，是前端开发者向全栈或资深工程化方向发展的关键一步。掌握上述知识点，将能有效应对大部分 Node.js 开发场景，并为进一步深入特定领域（如微服务、实时通信、底层优化等）打下坚实基础。